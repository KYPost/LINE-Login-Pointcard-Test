:root {
  --transition-speed: 0.5s;
  --aspect-ratio: 1.69;
  --logo-height: 350px;
}

* {
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent; /* 移除手機點擊藍框 */
}

body {
  background-color: #000000;
  margin: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  overflow: hidden; /* 禁止網頁本身捲動 */
  margin: 0;
  font-family:
    -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
}

/* 主容器：390:659 自適應邏輯 */
#app-container {
  width: 100%;
  height: 100dvh;
  min-height: 600px;

  max-width: 500px;
  margin: 0 auto;
  position: relative;
  /* 將共享背景圖放在這裡 */
  background-image:
    url("img/BG-Middle-logo@3x.png"), url("img/BG-NoLogo@3x.png");
  /* 對應上面兩張圖的尺寸：Logo 設為 70%，底圖鋪滿 100% */
  background-size:
    65% auto,
    100% 100%;

  /* 對應上面兩張圖的位置：Logo 放在中間偏下 60% 處，底圖置中 */
  background-position:
    center 70%,
    center center;

  background-repeat: no-repeat;
  overflow: hidden;
  /* box-shadow: 0 0 30px rgba(0, 0, 0, 0.5); */
}

.logo-wrapper {
  position: absolute;
  top: 5vh;
  left: 0;
  width: 100%; /* 撐滿寬度 */
  display: flex;
  justify-content: center; /* 內容置中 */
  z-index: 100;
  pointer-events: none;
}

.menu-top-logo {
  margin-top: 8%;
  width: 80%;
  max-width: 500px;
  height: auto;
}

.menu-middle-logo {
  margin-top: 60%;
  width: 70%;
  max-width: 500px;
  height: auto;
  z-index: -10000;
}

.top-logo-spacer {
  display: block;
  width: 100%;
  height: 30vh; /* 再換回相對單位 */
  flex-shrink: 0;
}

/* 電腦版適配：當寬度大於 600px */
@media (min-width: 480px) {
  #app-container {
    height: 100vh;
    width: calc(100vh / var(--aspect-ratio));
  }
}

/* 頁面通用與淡入淡出 */
.page {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
  visibility: hidden;
  transition:
    opacity var(--transition-speed) ease,
    visibility var(--transition-speed);
  background-size: 100% 100%; /* 強制背景圖完全填滿容器邊界 */
  background-position: center;
  background-repeat: no-repeat;
  z-index: 1;
}

.page.active {
  /* 顯示狀態 */
  visibility: visible;
  pointer-events: auto; /* 顯示時恢復點擊 */

  /* 觸發動畫 */
  animation: fadeInEffect 0.5s ease-out forwards;
  z-index: 2; /* 確保當前頁面在最上方 */
}

/* 針對內容容器的微調 */
.page .content {
  display: flex;
  flex-direction: column;
  align-items: center;
  /* 移除原本可能有的 padding-top，改用 spacer 統一控制 */
  padding-top: 0;
}

/* 每個頁面的專屬背景 */
/* #menu-page {
  background-image: url("img/BG@3x.png");
}
#collect-page {
  background-image: url("img/BG@3x.png");
}
#scanner-page {
  background-image: url("img/BG@3x.png");
}
#redeem-page {
  background-image: url("img/BG@3x.png");
}
#success-page {
  background-image: url("img/BG@3x.png");
} */

/* 統一的內容容器設定 */
.content {
  position: relative;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  /* 關鍵：從頂部開始排，利用 margin-top: auto 把按鈕推到底部 */
  justify-content: flex-start;
  box-sizing: border-box;
  padding: 5% 5% 80px 5%; /* 上排預留一點空間，底排預留按鈕空間 */
}

/* 統一 Logo 樣式：不再飄浮，佔據真實空間 */
/* .top-logo {
  position: relative;
  top: 0;
  left: 0;
  transform: none;

  width: 100%;
  max-width: 400px;
  height: auto;
  margin-bottom: 5%;

  margin-top: 10%; 
  margin-bottom: 5%; 
  flex-shrink: 0;
} */

/* 統一標題圖片間距 */
.menu-content {
  margin-top: 10px; /* 移除原本的 75px */
  width: 70%;
  max-width: 500px;
  flex-shrink: 0;
}

.collect-content {
  margin-top: -20px; /* 移除原本的 75px */
  margin-bottom: 20px;
  width: 70%;
  max-width: 500px;
  flex-shrink: 0;
}

#menu-page .img-btn {
  width: 70%;
  max-width: 500px;
  margin-top: 5vh; /* 這會把按鈕推到 content 容器的最底部 */
}

#collect-page .content {
  justify-content: flex-start; /* 覆蓋掉原本的 center */
  padding-top: 5%; /* 根據你的 Top Logo 位置微調 */
}

/* 2. 移除 Logo Spacer，我們改用 Logo 的 margin 來控制 */
#collect-page .logo-spacer {
  display: none; /* 移除這個會佔空間但不穩定的 spacer */
}

/* 圖片按鈕 */
.img-btn {
  width: 75%;
  height: auto;
  cursor: pointer;
  transition: transform 0.1s ease;
}

.img-btn:active {
  transform: scale(0.92); /* 點擊時的縮小回饋 */
}

#collect-page .img-btn {
  width: 70%;
  max-width: 500px;
  margin-top: auto; /* 在 flex-start 模式下，這會把按鈕推到最下面 */
  margin-bottom: 15vh; /* 使用 vh 單位，讓它在不同高度的手機上都能往上提 */
}

.stamp-grid {
  position: relative;
  width: 110%;
  /* 使用 aspect-ratio 確保容器高度隨寬度等比縮放 */
  aspect-ratio: 1 / 0.7;
  max-width: 500px;
  margin-top: -10px; /* 關鍵：使用負值 margin 直接把整塊往上吸 */
  margin-bottom: -40px;
  pointer-events: none;
  flex-shrink: 0;
}

.stamp-icon {
  position: absolute;
  width: 26%;
  height: auto;
  object-fit: contain;
  /* 初始狀態 */
  transform: translate(-50%, -50%) scale(1);
  /* 移除 all，避免干擾 animation */
  transition: opacity 0.3s ease;
  transform-origin: center center;
  backface-visibility: hidden;
  will-change: transform, opacity; /* 預告瀏覽器這兩個會變動 */
}

/* --- 重新微調座標 (現在是以中心點為基準) --- */
/* 第一排 */
#s1 {
  top: 25%;
  left: 20%;
}
#s2 {
  top: 25%;
  left: 50%;
}
#s3 {
  top: 25%;
  left: 80%;
}

/* 第二排 */
#s4 {
  top: 60%;
  left: 35%;
}
#s5 {
  top: 60%;
  left: 65%;
}

/* 1. 統一 Scanner 頁面的 content 排版 */
#scanner-page .content {
  justify-content: flex-start; /* 與其他頁面一致 */
  padding-top: 5%;
}

/* 2. 修正 Scanner 外框容器 */
.scanner-window {
  position: relative; /* 移除 absolute，改用 relative 參與排版 */
  width: 280px;
  height: 280px;
  max-width: 80vw; /* 防止在窄手機上超出螢幕 */
  max-height: 80vw;

  border-radius: 20px;
  background-image: url("img/Scanner@3x.png");
  background-size: 100% 100%; /* 確保掃描框圖案完美貼合 */
  background-repeat: no-repeat;

  display: flex;
  justify-content: center;
  align-items: center;

  /* 調整這裡來控制掃描框的上下位置 */
  margin: 20px auto;
  flex-shrink: 0;
  overflow: hidden; /* 確保內部影片圓角生效 */
}

/* 3. 解決鏡頭對齊與不蓋過的問題 */
#reader {
  width: 90% !important;
  height: 90% !important;
  border: none !important; /* 移除外框 */
  background: transparent !important; /* 讓底下的背景圖能透出來（如果鏡頭沒滿時） */
  box-shadow: none !important;
  background: rgb(255, 255, 255) !important; /* 相機啟動前顯示黑色 */
  border-radius: 20px;
}

/* 強制相機影片填滿並裁切成圓角 */
#reader video {
  width: 100% !important;
  height: 100% !important;
  object-fit: cover !important; /* 確保影片填滿正方形，不會有白邊 */
  border-radius: 20px;
}

/* 領獎頁面容器 */
#redeem-page .content,
#success-page .content {
  display: flex;
  flex-direction: column;
  align-items: center;

  /* 關鍵修正：改為從頂部開始排列 */
  justify-content: flex-start;

  height: 100vh;
  padding: 20px;
  box-sizing: border-box;
  position: relative;
}

/* 禮物外盒/背景圖 (content2@3x.png) */
.gift-box {
  width: 70%;
  max-width: 500px;
  height: auto;
  margin-bottom: 10vh;
  animation: float 3s ease-in-out infinite;
}

/* 領獎按鈕 (button4@3x.png) */
#redeem-page .img-btn {
  width: 70%;
  max-width: 500px;
  cursor: pointer;
  transition: transform 0.1s ease;
  margin-top: 20px;
  z-index: 10;
}

/* 點擊回饋 */
#redeem-page .img-btn:active {
  transform: scale(0.92);
}

/*==================動畫=================*/

@keyframes stampIn {
  0% {
    /* 從 2 倍大開始即可，4 倍太遠會顯得慢 */
    transform: translate(-50%, -50%) scale(2.5);
    opacity: 0;
    filter: brightness(2) blur(2px); /* 加入一點模糊感模擬位移速率 */
  }
  30% {
    /* 快速到達目標大小並稍微壓縮 */
    transform: translate(-50%, -50%) scale(0.9);
    opacity: 1;
    filter: brightness(1) blur(0);
  }
  55% {
    /* 彈跳起來 */
    transform: translate(-50%, -50%) scale(1.1);
  }
  80% {
    /* 二次小壓縮 */
    transform: translate(-50%, -50%) scale(0.98);
  }
  100% {
    /* 最終定位 */
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
  }
}

/* 禮物浮動動畫 */
@keyframes float {
  0% {
    transform: translateY(0px);
  }
  50% {
    transform: translateY(-10px);
  }
  100% {
    transform: translateY(0px);
  }
}

@keyframes fadeInEffect {
  from {
    opacity: 0;
    transform: translateY(5px); /* 稍微由下往上漂浮，更有質感 */
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.stamp-active {
  /* 時間縮短至 0.4s，使用 back-out 類型的曲線 */
  animation: stampIn 0.4s cubic-bezier(0.2, 0, 0.2, 1) forwards !important;
  z-index: 99;
  filter: grayscale(0) !important;
}
